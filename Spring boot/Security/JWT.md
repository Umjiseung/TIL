# JWT
## JWT란

* JWT는 웹에서 사용되는 JSON 형식의 토큰에 대한 표준 규격

* 사용자의 `인증` 또는 `인가` 정보를 서버와 클라이언트간에 안전하게 주고 받기 위해 사용

* JWT 토큰 웹에서 보통 `Authorization` HTTP 헤더를 `Bearer<토큰>`의 형태로 설정하여 클라이언트에서 서버로 전송되며, 서버에서는 토큰에 포함되어 있는 서명(signature) 정보를 통해 위변조 여부를 빠르게 검증할 수 있다!

* JWT 토큰은 Base64로 인코딩이 되어 있어서 육안으로 보면 `eyj`로 시작하는 아주 긴 문자열

## 구조

* 하나의 JWT 토큰은 헤더와 페이로드, 서명 이렇게 세 부분으로 이뤄지고 `.`기호로 구분된다.

```
<헤더>.<페이로드>.<서명>
```

* 첫 부분인 헤더부분은 토큰의 유형과 서명 알고리즘에 명시된다.

* 중간 부분인 페이로드에는 소위 claim이라고 불리는 사용자의 인증/인가 정보가 담긴다.

* 마지막 부분은 서명(signature)에는 헤더와 페이로드가 비밀키로 서명되어 저장된다.

* JWT 토큰은 네트워크로 전송하기 때문에 공간이 적게 사용하는 게 유리하다.

* JSON 형식으로 데이터를 저장할 때 키를 3글자로 줄이는 관행이 있다

### JSON 키 이름

* `sub`키 : 인증 주체(subject)

* `iss`키 : 토큰 발급처

* `typ`키 : 토큰의 유형(type)

* `alg`키 : 서명 알고리즘(algorithm)

* `iat`키 : 발급 시각(issued at)

* `exp`키 : 말료 시작(expiration time)

* `aud`키 : 클라이언트(audience)

## 장점

* JWT가 등장하기 전에는 웹에서 쿠키와 세션을 이용한 사용자 인증을 구현하는 경우가 많았다.

* 토큰 자체에 사용자의 정보가 저장되어 있어있기 때문에 서버 입장에서 토큰을 검증만 해주면 된다.

* 따라서 JWT를 사용할 때는 사용자가 늘어나도 사용자 인증을 위해 추가로 투자해야하는 인프라 비용을 크게 아낄 수 있다.

* 또한 쿠키를 사용하지 않아서 CORS 문제로도 자유로워진다는 장점

## 한계

* 조금 규모가 어느정도 있는 서비스에서는 사용자 인증 용도로 JWT를 사용하기에 부족한 경우가 있다

## 주의사항

* 서명이 되있는 JWT 토큰 서버에서만 유효성을 검증할 수 있지만 그 안에 저장된 데이터는 누구나 쉽게 열람이 가능하기 때문에 주의를 해야한다.

* 가급적이면 사용자를 식별할 수 있는 아이디 정도만 저장하는 것이 좋고 해당 사용자에 대한 추가 정보가 필요한 경우에는 사용자 DB를 조회하는 것이 안정하다.

* 만약에 토큰 안에 민감한 정보를 저장해야된다면 암호화를 반드시하여 디코딩한 후에 알 수 없게 해야된다.
